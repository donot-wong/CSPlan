function printStackTrace(e){var e=e||{guess:!0},t=e.e||null,e=!!e.guess,i=new printStackTrace.implementation,t=i.run(t);return e?i.guessAnonymousFunctions(t):t}function MarvinHooks(){this.listeners={};var e=this;this.originalIndexOf=String.prototype.indexOf,String.prototype.indexOf=function(t,i){return this==window.location.search&&""!=window.location.search?i?e.triggerLocationSearch(t,i+e.originalIndexOf.call(window.location.href,"?")):e.triggerLocationSearch(t,e.originalIndexOf.call(window.location.href,"?")):this==window.location.href&&e.triggerLocationSearch(t,i),e.originalIndexOf.call(this,t,i)},window.addEventListener("hashchange",function(){e.triggerHashChange(window.location.hash)},!0),window.alert=function(e){return!1},window.confirm=function(){return!0},window.prompt=function(e,t){return t?t:""},window.close=function(){return!1},this.originalOpen=window.XMLHttpRequest.prototype.open,window.XMLHttpRequest.prototype.open=function(t,i,n){return e.triggerXHROpen(this,t,i,n),e.originalOpen.call(this,t,i,n)},this.originalSend=window.XMLHttpRequest.prototype.send,window.XMLHttpRequest.prototype.send=function(t){return e.triggerXHRSend(this,t),this.addEventListener("readystatechange",function(){4===this.readyState&&e.triggerXHRReady(this)},!1),e.originalSend.call(this,t)},this.origSetTimeout=window.setTimeout,window.setTimeout=function(t,i){return e.triggerSetTimeout(t,i),i>100?window.$uie$.addTimeoutTask(t,Array.prototype.slice.call(arguments,2)):e.setTimeout(t,i)},this.originalSetInterval=window.setInterval,window.setInterval=function(t,i){return e.triggerSetInterval(t,i),i>100?window.$uie$.addTimeoutTask(t,Array.prototype.slice.call(arguments,2)):e.originalSetInterval.call(window,t,i)},this.originalEval=window.eval,window.eval=function(t){return e.triggerEval(t),e.originalEval.call(window,t)},window.execScript=window.eval,this.originalWindowOpen=window.open,window.open=function(t,i,n,r){return e.triggerWindowOpen(t),window.$uie$.addNewHref(t),null},this.originalDocumentWrite=HTMLDocument.prototype.write,HTMLDocument.prototype.write=function(t){return e.triggerDocumentWrite(t),e.originalDocumentWrite.call(this,t)},this.originalDocumentWriteLn=HTMLDocument.prototype.writeln,HTMLDocument.prototype.writeln=function(t){return e.triggerDocumentWrite(t),e.originalDocumentWriteLn.call(this,t)},this.originalCreateElement=HTMLDocument.prototype.createElement,HTMLDocument.prototype.createElement=function(t){e.triggerAddingElement(t);var i=e.originalCreateElement.call(this,t);return e.hookHTMLElement(i),i},this.originalCloneNode=HTMLDocument.prototype.cloneNode,HTMLDocument.prototype.cloneNode=function(t){var i=e.originalCloneNode.call(this,t);return e.hookHTMLElement(i),t&&this.hookChildren(i),i},window.document.addEventListener("DOMSubtreeModified",function(t){e.documentChangedHandler(t)},!0),this.loadCallback=null,this.loadedOnce=!1,function(t,i){var n=!1,r=!0,a=t.document,o=a.documentElement,s=a.addEventListener?"addEventListener":"attachEvent",c=a.addEventListener?"removeEventListener":"detachEvent",d=a.addEventListener?"":"on",l=function(r){("readystatechange"!=r.type||"complete"==a.readyState)&&(("load"==r.type?t:a)[c](d+r.type,l,!1),!n&&(n=!0)&&i.call(e,r.type||r))},u=function(){try{o.doScroll("left")}catch(e){return void setTimeout(u,50)}l("poll")};if("complete"==a.readyState)i.call(e,"lazy");else{if(a.createEventObject&&o.doScroll){try{r=!t.frameElement}catch(e){}r&&u()}a[s](d+"DOMContentLoaded",l,!1),a[s](d+"readystatechange",l,!1),t[s](d+"load",l,!1)}}(window,function(){this.loadedOnce=!0,this.loadCallback&&this.loadCallback.call(window)}),this.onload=function(e){this.loadedOnce?e():this.loadCallback=e}}function SimpleDOMXSSClass(){window.$hook$.addListener(MarvinHooks.HOOK_EVENT_DOCUMENTWRITE,this,this.docWriteSink),window.$hook$.addListener(MarvinHooks.HOOK_EVENT_DOMCHANGE,this,this.innerHTMLSink),window.$hook$.addListener(MarvinHooks.HOOK_EVENT_EVAL,this,this.evalSink),window.$hook$.addListener(MarvinHooks.HOOK_EVENT_SETTIMEOUT,this,this.evalSink),window.$hook$.addListener(MarvinHooks.HOOK_EVENT_SETINTERVAL,this,this.evalSink),window.$hook$.addListener(MarvinHooks.HOOK_EVENT_WINDOWOPEN,this,this.windowOpenSink);var e=1;for(var t in SimpleDOMXSSClass.cases)SimpleDOMXSSClass.cases.hasOwnProperty(t)&&(SimpleDOMXSSClass.cases[t].id=e++,SimpleDOMXSSClass.cases[t].setupSource.call(SimpleDOMXSSClass.cases[t]))}function MarvinPageExplorer(){this.tasks=[],this.currentTaskIndex=0,this.executingTask=!1,this.pendingRequests=0,this.waitingXHR=!1,this.aborted=!1,this.paused=!1,this.visitedElements={},this.discoveredHrefs={},this.discoveredSearches={},this.discoveredForms={},this.alertsFound={},this.listeners={},this.errors=[],this.reportTo=null,this.additionalFindings=[],this.disallowHashManipulation=document.body instanceof HTMLFrameSetElement,this.testingPhase=!1,this.validLocationSearch=/^[&A-Za-z0-9_\-\.\/:=\?]+$/,this.prestartSteps=0,this.canStart=!1,this.started=!1;var e=this;"undefined"!=typeof marvinSessionObject&&marvinSessionObject.onNavigationCanceled.connect(function(t){e.addNewHref(t)}),window!=top&&window.addEventListener("message",function(t){var i=t.data;"object"==typeof i&&("init"===i.msg?(e.reportTo=t.source,e.reportTo.postMessage({msg:"explorerPresent"},"*")):"start"===i.msg?e.start():"pause"===i.msg?e.pause():"resume"===i.msg&&e.resume())}),window.$hook$.addListener(MarvinHooks.HOOK_EVENT_XHRSEND,this,this.onXHRSend),window.$hook$.addListener(MarvinHooks.HOOK_EVENT_XHRREADY,this,this.onXHRReady),window.$hook$.addListener(MarvinHooks.HOOK_EVENT_ATTRIBUTESET,this,this.onElementAttributeSet),window.$hook$.addListener(MarvinHooks.HOOK_EVENT_FORMSUBMIT,this,this.onFormSubmitted),window.$hook$.addListener(MarvinHooks.HOOK_EVENT_LOCATION_SEARCH,this,this.onLocationSearch),window.$hook$.addListener(MarvinHooks.HOOK_EVENT_DOMCHANGE,this,this.documentChangedHandler),window.$hook$.addListener(MarvinHooks.HOOK_EVENT_ADDING_ELEMENT,this,this.addingElement)}function ElementExplorerFactory(e,t){var i=0;void 0!==t&&(i=t);var n=e.tagName.toUpperCase();return"INPUT"===n&&e.type&&e.type.toLowerCase()in MarvinPageExplorer.NOT_CLICKABLE_INPUTS?new InputExplorerClass(e,i):"SELECT"===n?new SelectExplorerClass(e,i):new ElementExplorerClass(e,i)}printStackTrace.implementation=function(){},printStackTrace.implementation.prototype={run:function(e,t){return e=e||this.createException(),t=t||this.mode(e),"other"===t?this.other(arguments.callee):this[t](e)},createException:function(){try{this.undef()}catch(e){return e}},mode:function(e){return e.arguments&&e.stack?"chrome":e.stack&&e.sourceURL?"safari":"string"==typeof e.message&&"undefined"!=typeof window&&window.opera?!e.stacktrace||-1<e.message.indexOf("\n")&&e.message.split("\n").length>e.stacktrace.split("\n").length?"opera9":e.stack?0>e.stacktrace.indexOf("called from line")?"opera10b":"opera11":"opera10a":e.stack?"firefox":"other"},instrumentFunction:function(e,t,i){var e=e||window,n=e[t];e[t]=function(){return i.call(this,printStackTrace().slice(4).slice(4)),e[t]._instrumented.apply(this,arguments)},e[t]._instrumented=n},deinstrumentFunction:function(e,t){e[t].constructor===Function&&e[t]._instrumented&&e[t]._instrumented.constructor===Function&&(e[t]=e[t]._instrumented)},chrome:function(e){return e=(e.stack+"\n").replace(/^\S[^\(]+?[\n$]/gm,"").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}()@$1$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}()@$1").split("\n"),e.pop(),e},safari:function(e){return e.stack.replace(/\[native code\]\n/m,"").replace(/^@/gm,"{anonymous}()@").split("\n")},firefox:function(e){return e.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^[\(@]/gm,"{anonymous}()@").split("\n")},opera11:function(e){for(var t=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/,e=e.stacktrace.split("\n"),i=[],n=0,r=e.length;r>n;n+=2){var a=t.exec(e[n]);if(a){var o=a[4]+":"+a[1]+":"+a[2],a=a[3]||"global code",a=a.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,"{anonymous}");i.push(a+"@"+o+" -- "+e[n+1].replace(/^\s+/,""))}}return i},opera10b:function(e){for(var t=/^(.*)@(.+):(\d+)$/,e=e.stacktrace.split("\n"),i=[],n=0,r=e.length;r>n;n++){var a=t.exec(e[n]);a&&i.push((a[1]?a[1]+"()":"global code")+"@"+a[2]+":"+a[3])}return i},opera10a:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,e=e.stacktrace.split("\n"),i=[],n=0,r=e.length;r>n;n+=2){var a=t.exec(e[n]);a&&i.push((a[3]||"{anonymous}")+"()@"+a[2]+":"+a[1]+" -- "+e[n+1].replace(/^\s+/,""))}return i},opera9:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)/i,e=e.message.split("\n"),i=[],n=2,r=e.length;r>n;n+=2){var a=t.exec(e[n]);a&&i.push("{anonymous}()@"+a[2]+":"+a[1]+" -- "+e[n+1].replace(/^\s+/,""))}return i},other:function(e){for(var t,i,n=/function\s*([\w\-$]+)?\s*\(/i,r=[];e&&e.arguments&&10>r.length;)t=n.test(e.toString())?RegExp.$1||"{anonymous}":"{anonymous}",i=Array.prototype.slice.call(e.arguments||[]),r[r.length]=t+"("+this.stringifyArguments(i)+")",e=e.caller;return r},stringifyArguments:function(e){for(var t=[],i=Array.prototype.slice,n=0;n<e.length;++n){var r=e[n];void 0===r?t[n]="undefined":null===r?t[n]="null":r.constructor&&(r.constructor===Array?t[n]=3>r.length?"["+this.stringifyArguments(r)+"]":"["+this.stringifyArguments(i.call(r,0,1))+"..."+this.stringifyArguments(i.call(r,-1))+"]":r.constructor===Object?t[n]="#object":r.constructor===Function?t[n]="#function":r.constructor===String?t[n]='"'+r+'"':r.constructor===Number&&(t[n]=r))}return t.join(",")},sourceCache:{},ajax:function(e){var t=this.createXMLHTTPObject();if(t)try{return t.open("GET",e,!1),t.send(null),t.responseText}catch(e){}return""},createXMLHTTPObject:function(){for(var e,t=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],i=0;i<t.length;i++)try{return e=t[i](),this.createXMLHTTPObject=t[i],e}catch(e){}},isSameDomain:function(e){return"undefined"!=typeof location&&-1!==e.indexOf(location.hostname)},getSource:function(e){return e in this.sourceCache||(this.sourceCache[e]=this.ajax(e).split("\n")),this.sourceCache[e]},guessAnonymousFunctions:function(e){for(var t=0;t<e.length;++t){var i=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,n=e[t],r=/\{anonymous\}\(.*\)@(.*)/.exec(n);if(r){var a=i.exec(r[1]);a&&(i=a[1],r=a[2],a=a[3]||0,i&&this.isSameDomain(i)&&r&&(i=this.guessAnonymousFunction(i,r,a),e[t]=n.replace("{anonymous}",i)))}}return e},guessAnonymousFunction:function(e,t){var i;try{i=this.findFunctionName(this.getSource(e),t)}catch(t){i="getSource failed with url: "+e+", exception: "+t.toString()}return i},findFunctionName:function(e,t){for(var i,n,r=/function\s+([^(]*?)\s*\(([^)]*)\)/,a=/['"]?([0-9A-Za-z_]+)['"]?\s*[:=]\s*function\b/,o=/['"]?([0-9A-Za-z_]+)['"]?\s*[:=]\s*(?:eval|new Function)\b/,s="",c=Math.min(t,20),d=0;c>d;++d)if(i=e[t-d-1],n=i.indexOf("//"),n>=0&&(i=i.substr(0,n)),i&&(s=i+s,(i=a.exec(s))&&i[1]||(i=r.exec(s))&&i[1]||(i=o.exec(s))&&i[1]))return i[1];return"(?)"}},function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;try{t=window}catch(e){t=self}t.SparkMD5=e()}}(function(e){"use strict";var t=function(e,t){return e+t&4294967295},i=function(e,i,n,r,a,o){return i=t(t(i,e),t(r,o)),t(i<<a|i>>>32-a,n)},n=function(e,t,n,r,a,o,s){return i(t&n|~t&r,e,t,a,o,s)},r=function(e,t,n,r,a,o,s){return i(t&r|n&~r,e,t,a,o,s)},a=function(e,t,n,r,a,o,s){return i(t^n^r,e,t,a,o,s)},o=function(e,t,n,r,a,o,s){return i(n^(t|~r),e,t,a,o,s)},s=function(e,i){var s=e[0],c=e[1],d=e[2],l=e[3];s=n(s,c,d,l,i[0],7,-680876936),l=n(l,s,c,d,i[1],12,-389564586),d=n(d,l,s,c,i[2],17,606105819),c=n(c,d,l,s,i[3],22,-1044525330),s=n(s,c,d,l,i[4],7,-176418897),l=n(l,s,c,d,i[5],12,1200080426),d=n(d,l,s,c,i[6],17,-1473231341),c=n(c,d,l,s,i[7],22,-45705983),s=n(s,c,d,l,i[8],7,1770035416),l=n(l,s,c,d,i[9],12,-1958414417),d=n(d,l,s,c,i[10],17,-42063),c=n(c,d,l,s,i[11],22,-1990404162),s=n(s,c,d,l,i[12],7,1804603682),l=n(l,s,c,d,i[13],12,-40341101),d=n(d,l,s,c,i[14],17,-1502002290),c=n(c,d,l,s,i[15],22,1236535329),s=r(s,c,d,l,i[1],5,-165796510),l=r(l,s,c,d,i[6],9,-1069501632),d=r(d,l,s,c,i[11],14,643717713),c=r(c,d,l,s,i[0],20,-373897302),s=r(s,c,d,l,i[5],5,-701558691),l=r(l,s,c,d,i[10],9,38016083),d=r(d,l,s,c,i[15],14,-660478335),c=r(c,d,l,s,i[4],20,-405537848),s=r(s,c,d,l,i[9],5,568446438),l=r(l,s,c,d,i[14],9,-1019803690),d=r(d,l,s,c,i[3],14,-187363961),c=r(c,d,l,s,i[8],20,1163531501),s=r(s,c,d,l,i[13],5,-1444681467),l=r(l,s,c,d,i[2],9,-51403784),d=r(d,l,s,c,i[7],14,1735328473),c=r(c,d,l,s,i[12],20,-1926607734),s=a(s,c,d,l,i[5],4,-378558),l=a(l,s,c,d,i[8],11,-2022574463),d=a(d,l,s,c,i[11],16,1839030562),c=a(c,d,l,s,i[14],23,-35309556),s=a(s,c,d,l,i[1],4,-1530992060),l=a(l,s,c,d,i[4],11,1272893353),d=a(d,l,s,c,i[7],16,-155497632),c=a(c,d,l,s,i[10],23,-1094730640),s=a(s,c,d,l,i[13],4,681279174),l=a(l,s,c,d,i[0],11,-358537222),d=a(d,l,s,c,i[3],16,-722521979),c=a(c,d,l,s,i[6],23,76029189),s=a(s,c,d,l,i[9],4,-640364487),l=a(l,s,c,d,i[12],11,-421815835),d=a(d,l,s,c,i[15],16,530742520),c=a(c,d,l,s,i[2],23,-995338651),s=o(s,c,d,l,i[0],6,-198630844),l=o(l,s,c,d,i[7],10,1126891415),d=o(d,l,s,c,i[14],15,-1416354905),c=o(c,d,l,s,i[5],21,-57434055),s=o(s,c,d,l,i[12],6,1700485571),l=o(l,s,c,d,i[3],10,-1894986606),d=o(d,l,s,c,i[10],15,-1051523),c=o(c,d,l,s,i[1],21,-2054922799),s=o(s,c,d,l,i[8],6,1873313359),l=o(l,s,c,d,i[15],10,-30611744),d=o(d,l,s,c,i[6],15,-1560198380),c=o(c,d,l,s,i[13],21,1309151649),s=o(s,c,d,l,i[4],6,-145523070),l=o(l,s,c,d,i[11],10,-1120210379),d=o(d,l,s,c,i[2],15,718787259),c=o(c,d,l,s,i[9],21,-343485551),e[0]=t(s,e[0]),e[1]=t(c,e[1]),e[2]=t(d,e[2]),e[3]=t(l,e[3])},c=function(e){var t,i=[];for(t=0;64>t;t+=4)i[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return i},d=function(e){var t,i=[];for(t=0;64>t;t+=4)i[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return i},l=function(e){var t,i,n,r,a,o,d=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(t=64;d>=t;t+=64)s(l,c(e.substring(t-64,t)));for(e=e.substring(t-64),i=e.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;i>t;t+=1)n[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(s(l,n),t=0;16>t;t+=1)n[t]=0;return r=8*d,r=r.toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(r[2],16),o=parseInt(r[1],16)||0,n[14]=a,n[15]=o,s(l,n),l},u=function(e){var t,i,n,r,a,o,c=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(t=64;c>=t;t+=64)s(l,d(e.subarray(t-64,t)));for(e=c>t-64?e.subarray(t-64):new Uint8Array(0),i=e.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;i>t;t+=1)n[t>>2]|=e[t]<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(s(l,n),t=0;16>t;t+=1)n[t]=0;return r=8*c,r=r.toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(r[2],16),o=parseInt(r[1],16)||0,n[14]=a,n[15]=o,s(l,n),l},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],f=function(e){var t,i="";for(t=0;4>t;t+=1)i+=h[e>>8*t+4&15]+h[e>>8*t&15];return i},p=function(e){var t;for(t=0;t<e.length;t+=1)e[t]=f(e[t]);return e.join("")},S=function(e){return p(l(e))},k=function(){this.reset()};return"5d41402abc4b2a76b9719d911017c592"!==S("hello")&&(t=function(e,t){var i=(65535&e)+(65535&t),n=(e>>16)+(t>>16)+(i>>16);return n<<16|65535&i}),k.prototype.append=function(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),this.appendBinary(e),this},k.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,i=this._buff.length;for(t=64;i>=t;t+=64)s(this._state,c(this._buff.substring(t-64,t)));return this._buff=this._buff.substr(t-64),this},k.prototype.end=function(e){var t,i,n=this._buff,r=n.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;r>t;t+=1)a[t>>2]|=n.charCodeAt(t)<<(t%4<<3);return this._finish(a,r),i=e?this._state:p(this._state),this.reset(),i},k.prototype._finish=function(e,t){var i,n,r,a=t;if(e[a>>2]|=128<<(a%4<<3),a>55)for(s(this._state,e),a=0;16>a;a+=1)e[a]=0;i=8*this._length,i=i.toString(16).match(/(.*?)(.{0,8})$/),n=parseInt(i[2],16),r=parseInt(i[1],16)||0,e[14]=n,e[15]=r,s(this._state,e)},k.prototype.reset=function(){return this._buff="",this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},k.prototype.destroy=function(){delete this._state,delete this._buff,delete this._length},k.hash=function(e,t){/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e)));var i=l(e);return t?i:p(i)},k.hashBinary=function(e,t){var i=l(e);return t?i:p(i)},k.ArrayBuffer=function(){this.reset()},k.ArrayBuffer.prototype.append=function(e){var t,i=this._concatArrayBuffer(this._buff,e),n=i.length;for(this._length+=e.byteLength,t=64;n>=t;t+=64)s(this._state,d(i.subarray(t-64,t)));return this._buff=n>t-64?i.subarray(t-64):new Uint8Array(0),this},k.ArrayBuffer.prototype.end=function(e){var t,i,n=this._buff,r=n.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;r>t;t+=1)a[t>>2]|=n[t]<<(t%4<<3);return this._finish(a,r),i=e?this._state:p(this._state),this.reset(),i},k.ArrayBuffer.prototype._finish=k.prototype._finish,k.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},k.ArrayBuffer.prototype.destroy=k.prototype.destroy,k.ArrayBuffer.prototype._concatArrayBuffer=function(e,t){var i=e.length,n=new Uint8Array(i+t.byteLength);return n.set(e),n.set(new Uint8Array(t),i),n},k.ArrayBuffer.hash=function(e,t){var i=u(new Uint8Array(e));return t?i:p(i)},k}),MarvinHooks.HOOK_ELEMENT_PROPERTY={src:["script","iframe","frame","img"],href:["a"]},MarvinHooks.HOOK_EVENTS=["onclick","onmouseover","onmouseup"],MarvinHooks.HOOK_EVENT_XHROPEN="XHROpen",MarvinHooks.HOOK_EVENT_XHRSEND="XHRSend",MarvinHooks.HOOK_EVENT_XHRREADY="XHRReady",MarvinHooks.HOOK_EVENT_ATTRIBUTESET="AttributeSet",MarvinHooks.HOOK_EVENT_EVENTCODESET="EventCodeSet",MarvinHooks.HOOK_EVENT_SETTIMEOUT="SetTimeout",MarvinHooks.HOOK_EVENT_SETINTERVAL="SetInterval",MarvinHooks.HOOK_EVENT_EVAL="Eval",MarvinHooks.HOOK_EVENT_DOCUMENTWRITE="DocumentWrite",MarvinHooks.HOOK_EVENT_FORMSUBMIT="FormSubmit",MarvinHooks.HOOK_EVENT_HASHCHANGE="HashChange",MarvinHooks.HOOK_EVENT_DOMCHANGE="DOMChange",MarvinHooks.HOOK_EVENT_WINDOWOPEN="WindowOpen",MarvinHooks.HOOK_EVENT_LOCATION_SEARCH="LocationSearch",MarvinHooks.HOOK_EVENT_ADDING_ELEMENT="CreatingElement",MarvinHooks.prototype={triggerXHROpen:function(e,t,i,n){this.notifyListeners(MarvinHooks.HOOK_EVENT_XHROPEN,e,t,i,n)},triggerXHRSend:function(e,t){this.notifyListeners(MarvinHooks.HOOK_EVENT_XHRSEND,e,t)},triggerXHRReady:function(e){this.notifyListeners(MarvinHooks.HOOK_EVENT_XHRREADY,e)},triggerAttributeSet:function(e,t,i){this.notifyListeners(MarvinHooks.HOOK_EVENT_ATTRIBUTESET,e,t,i)},triggerEventCodeSet:function(e,t,i){this.notifyListeners(MarvinHooks.HOOK_EVENT_EVENTCODESET,e,t,i)},triggerSetTimeout:function(e,t){this.notifyListeners(MarvinHooks.HOOK_EVENT_SETTIMEOUT,e,t)},triggerSetInterval:function(e,t){this.notifyListeners(MarvinHooks.HOOK_EVENT_SETINTERVAL,e,t)},triggerEval:function(e){this.notifyListeners(MarvinHooks.HOOK_EVENT_EVAL,e)},triggerDocumentWrite:function(e){this.notifyListeners(MarvinHooks.HOOK_EVENT_DOCUMENTWRITE,e)},triggerFormSubmit:function(e){this.notifyListeners(MarvinHooks.HOOK_EVENT_FORMSUBMIT,e)},triggerHashChange:function(e){this.notifyListeners(MarvinHooks.HOOK_EVENT_HASHCHANGE,e)},triggerDOMChange:function(e){"innerHTML"in e.target&&"string"==typeof e.target.innerHTML&&""!=e.target.innerHTML&&this.notifyListeners(MarvinHooks.HOOK_EVENT_DOMCHANGE,e.target,e.target.innerHTML)},triggerLocationSearch:function(e,t){this.notifyListeners(MarvinHooks.HOOK_EVENT_LOCATION_SEARCH,e,t)},triggerWindowOpen:function(e){this.notifyListeners(MarvinHooks.HOOK_EVENT_WINDOWOPEN,e)},triggerAddingElement:function(e){this.notifyListeners(MarvinHooks.HOOK_EVENT_ADDING_ELEMENT,e)},addListener:function(e,t,i){"undefined"==typeof this.listeners[e]&&(this.listeners[e]=[]),this.listeners[e].push({obj:t,method:i})},removeListener:function(e,t,i){if(this.listeners.hasOwnProperty(e))for(var n=this.listeners[e].length-1;n>=0;n--)null!==this.listeners[e][n]&&this.listeners[e][n].obj===t&&this.listeners[e][n].method===i&&(this.listeners[e][n]=null)},notifyListeners:function(e){if("undefined"!=typeof this.listeners[e]){var t,i=[];for(t=1;t<arguments.length;t++)i.push(arguments[t]);for(t=0;t<this.listeners[e].length;t++)if(null!==this.listeners[e][t])try{this.listeners[e][t].method.apply(this.listeners[e][t].obj,i)}catch(e){window.$uie$.addException(e,"hooks.js")}}},hookAttributeProperty:function(e,t){if("__proto__"in t&&null!==t.__proto__){if(t.__proto__.setAttribute&&!t.__proto__.setAttribute.hooked){var i=t.__proto__.setAttribute,n=this;t.__proto__.setAttribute=function(e,t){e in MarvinHooks.HOOK_ELEMENT_PROPERTY?n.triggerAttributeSet(this,e,t):n.triggerEventCodeSet(this,e,t),i.call(this,e,t)},t.__proto__.setAttribute.hooked=!0}t.__defineGetter__(e,function(){return this.getAttribute(e)}),t.__defineSetter__(e,function(t){this.setAttribute(e,t)})}},setInnerHTML:function(e,t){var i=this.originalCreateElement.call(document,"span");for(i.innerHTML=t;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(i)},hookHTMLElement:function(e){e.hookedByMarvin=!0;var t,i=this;for(var n in MarvinHooks.HOOK_ELEMENT_PROPERTY)if(e.hasOwnProperty(n)){var r=!1;for(t=0;t<MarvinHooks.HOOK_ELEMENT_PROPERTY[n].length;t++)if(e.tagName.toLowerCase()==MarvinHooks.HOOK_ELEMENT_PROPERTY[n][t]){r=!0;break}r&&this.hookAttributeProperty(n,e)}for(t=0;t<MarvinHooks.HOOK_EVENTS.length;t++)this.hookAttributeProperty(MarvinHooks.HOOK_EVENTS[t],e);e.tagName&&"FORM"===e.tagName.toUpperCase()&&(e.submit=function(){return i.triggerFormSubmit(this)},e.addEventListener("submit",function(e){e.preventDefault();try{this.action&&0==this.action.toLocaleLowerCase().indexOf("javascript:")&&window.$hook$.originalEval.call(window,decodeURI(this.action.substr(11)))}catch(e){}return i.triggerFormSubmit(e.target)},!0))},hookChildren:function(e){if(e.querySelectorAll){var t,i=e.querySelectorAll("*");for(t=0;t<i.length;t++)"undefined"==typeof i[t].hookedByMarvin&&this.hookHTMLElement(i[t])}},setTimeout:function(e,t){return this.origSetTimeout.call(window,e,t)},indexOf:function(e,t,i){return this.originalIndexOf.call(e,t,i)},documentChangedHandler:function(e){this.triggerDOMChange(e)}},domxssExecutionSink=function(e,t){var i="unknown";-1!=t.indexOf("hashxss")?i="location.hash":-1!=t.indexOf("refdxss")?i="referrer header":-1!=t.indexOf("wildxss")?i="window.name":-1!=t.indexOf("locxss")&&(i="window.location");var n=cleanStackStrace(printStackTrace()),r="[i]Source: [/i][dark]"+i+"[/dark][break][i]Execution Sink: [/i][dark]window.location (callback)[/dark][break][i]Location: [/i][dark]"+decodeURIComponent(window.location.href)+"[/dark][break][i]Stack Trace: [/i][break]"+n;window.$uie$.addNewAlert(SparkMD5.hash(r),{template:"DOM_XSS.xml",details:r})},cleanStackStrace=function(e){for(var t="[ul]",i=!1,n=0;n<e.length;n++)if(i||e[n].match(/^\w+$/)||(i=!0),i){if("next"==e[n])break;""!=e[n]&&(t+="[li]"+e[n]+"[/li]\n")}return t+="[/ul]"},SimpleDOMXSSClass.getStrData=function(e){var t=typeof e;return"function"==t||"object"==t?"toString"in e?e.toString():"":"undefined"==t?"":e},SimpleDOMXSSClass.cases={fromReferrer:{setupSource:function(){},checkSink:function(e,t,i){var n=SimpleDOMXSSClass.getStrData(t);if(""!==n){var r,a,o;e===SimpleDOMXSSClass.documentWriteSinkName?(o=MarvinPageExplorer.MatchXssWithSuffix(null,n,"refdxss"))&&(r=cleanStackStrace(printStackTrace()),a="[i]Source: [/i][dark]Referrer Header[/dark][break][i]Referrer: [/i][dark]"+document.referrer+"[/dark][break][i]Execution Sink: [/i][dark]document.write[/dark][break][i]HTML code written: [/i][pre]"+n.substring(o.index-512,o.index+512)+" ...[/pre]\n[i]Stack Trace: [/i][break]"+r,window.$uie$.addNewAlert(SparkMD5.hash(a),{template:"DOM_XSS.xml",details:a})):e===SimpleDOMXSSClass.setHTMLSinkName?(o=MarvinPageExplorer.MatchXssWithSuffix(i,n,"refdxss"))&&(r=cleanStackStrace(printStackTrace()),a="[i]Source: [/i][dark]Referrer Header[/dark][break][i]Referrer: [/i][dark]"+document.referrer+"[/dark][break][i]Execution Sink: [/i][dark]set HTML code (innerHTML/outerHTML/...)[/dark][break][i]HTML code set: [/i][pre]"+n.substring(o.index-512,o.index+512)+" ...[/pre]\n[i]Stack Trace: [/i][break]"+r,window.$uie$.addNewAlert(SparkMD5.hash(a),{template:"DOM_XSS.xml",details:a})):e===SimpleDOMXSSClass.evalSinkName?(o=MarvinPageExplorer.MatchXssWithSuffix(null,n,"refdxss"))&&(r=cleanStackStrace(printStackTrace()),a="[i]Source: [/i][dark]Referrer Header[/dark][break][i]Referrer: [/i][dark]"+document.referrer+"[/dark][break][i]Execution Sink: [/i][dark]evaluate code (eval/setTimeout/setInterval/...)[/dark][break][i]Code evaluated: [/i][pre]"+n.substring(o.index-512,o.index+512)+" ...[/pre]\n[i]Stack Trace: [/i][break]"+r,window.$uie$.addNewAlert(SparkMD5.hash(a),{template:"DOM_XSS.xml",details:a})):e===SimpleDOMXSSClass.windowOpenSinkName&&(o=MarvinPageExplorer.MatchXssWithSuffix(null,n.trim(),"refdxss"))&&0==o.index&&(r=cleanStackStrace(printStackTrace()),a="[i]Source: [/i][dark]Referrer Header[/dark][break][i]Referrer: [/i][dark]"+document.referrer+"[/dark][break][i]Execution Sink: [/i][dark]window.open[/dark][break][i]URL: [/i][pre]"+n.substring(0,1204)+" ...[/pre]\n[i]Stack Trace: [/i][break]"+r,window.$uie$.addNewAlert(SparkMD5.hash(a),{template:"DOM_XSS.xml",details:a}))}}},fromWindowName:{setupSource:function(){window.name="javascript:domxssExecutionSink("+this.id+',"\'\\"><xsstag>()wildxss")'},checkSink:function(e,t,i){var n=SimpleDOMXSSClass.getStrData(t);if(""!==n){var r,a,o;e===SimpleDOMXSSClass.documentWriteSinkName?(r=MarvinPageExplorer.MatchXssWithSuffix(null,n,"wildxss"))&&(a=cleanStackStrace(printStackTrace()),o="[i]Source: [/i][dark]window.name[/dark][break][i]window.name: [/i][dark]"+window.name+"[/dark][break][i]Execution Sink: [/i][dark]document.write[/dark][break][i]HTML code written: [/i][pre]"+n.substring(r.index-512,r.index+512)+" ...[/pre]\n[i]Stack Trace: [/i][break]"+a,window.$uie$.addNewAlert(SparkMD5.hash(o),{template:"DOM_XSS.xml",details:o})):e===SimpleDOMXSSClass.setHTMLSinkName?(r=MarvinPageExplorer.MatchXssWithSuffix(i,n,"wildxss"))&&(a=cleanStackStrace(printStackTrace()),o="[i]Source: [/i][dark]window.name[/dark][break][i]window.name: [/i][dark]"+window.name+"[/dark][break][i]Execution Sink: [/i][dark]set HTML code (innerHTML/outerHTML/...)[/dark][break][i]HTML code set: [/i][pre]"+n.substring(r.index-512,r.index+512)+" ...[/pre]\n[i]Stack Trace: [/i][break]"+a,window.$uie$.addNewAlert(SparkMD5.hash(o),{template:"DOM_XSS.xml",details:o})):e===SimpleDOMXSSClass.evalSinkName?(r=MarvinPageExplorer.MatchXssWithSuffix(null,n,"wildxss"))&&(a=cleanStackStrace(printStackTrace()),o="[i]Source: [/i][dark]window.name[/dark][break][i]window.name: [/i][dark]"+window.name+"[/dark][break][i]Execution Sink: [/i][dark]evaluate code (eval/setTimeout/setInterval/...)[/dark][break][i]Evaluated code: [/i][pre]"+n.substring(0,1204)+" ...[/pre]\n[i]Stack Trace: [/i][break]"+a,window.$uie$.addNewAlert(SparkMD5.hash(o),{template:"DOM_XSS.xml",details:o})):e===SimpleDOMXSSClass.windowOpenSinkName&&(r=MarvinPageExplorer.MatchXssWithSuffix(null,n.trim(),"wildxss"))&&0==r.index&&(a=cleanStackStrace(printStackTrace()),o="[i]Source: [/i][dark]window.name[/dark][break][i]window.name: [/i][dark]"+window.name+"[/dark][break][i]Execution Sink: [/i][dark]window.open[/dark][break][i]URL: [/i][pre]"+n.substring(0,1204)+" ...[/pre]\n[i]Stack Trace: [/i][break]"+a,window.$uie$.addNewAlert(SparkMD5.hash(o),{template:"DOM_XSS.xml",details:o}))}}}},SimpleDOMXSSClass.documentWriteSinkName="document.write",SimpleDOMXSSClass.setHTMLSinkName="setHTML",SimpleDOMXSSClass.evalSinkName="eval",SimpleDOMXSSClass.windowOpenSinkName="window.open",SimpleDOMXSSClass.prototype={checkSinks:function(e,t){for(var i in SimpleDOMXSSClass.cases)SimpleDOMXSSClass.cases.hasOwnProperty(i)&&SimpleDOMXSSClass.cases[i].checkSink.apply(SimpleDOMXSSClass.cases[i],Array.prototype.slice.call(arguments))},docWriteSink:function(e){this.checkSinks(SimpleDOMXSSClass.documentWriteSinkName,e)},innerHTMLSink:function(e,t){this.checkSinks(SimpleDOMXSSClass.setHTMLSinkName,t,e)},evalSink:function(e){this.checkSinks(SimpleDOMXSSClass.evalSinkName,e)},windowOpenSink:function(e){this.checkSinks(SimpleDOMXSSClass.windowOpenSinkName,e)}},MarvinPageExplorer.SELECTOR_QUERY="*",MarvinPageExplorer.MatchXssWithSuffix=function(e,t,i){var n,r=/javascript:domxssExecutionSink\(\d+,"'\\"><xsstag>\(\)([a-z]+)/g;if(null!=e){var a=e.getElementsByTagName("xsstag");if(a)for(var o=0;o<a.length;o++){var s=a[o].innerHTML.indexOf(i);if(-1!=s)return{index:s}}}for(;n=r.exec(t);)if(1 in n&&n[1]==i)return n;return null},MarvinPageExplorer.EXCLUDED_TAGS={B:!0,BASE:!0,BASEFONT:!0,BDI:!0,BDO:!0,BIG:!0,BLOCKQUOTE:!0,BOLD:!0,BR:!0,CENTER:!0,CITE:!0,CODE:!0,DATALIST:!0,DD:!0,DEL:!0,DETAILS:!0,DFN:!0,DIR:!0,DL:!0,DT:!0,EM:!0,EMBED:!0,FIELDSET:!0,FONT:!0,FORM:!0,HEAD:!0,HGROUP:!0,HR:!0,HTML:!0,I:!0,INS:!0,ITALIC:!0,KBD:!0,KEYGEN:!0,LEGEND:!0,LINK:!0,MAP:!0,MARK:!0,META:!0,METER:!0,NOFRAMES:!0,NOSCRIPT:!0,OBJECT:!0,OL:!0,OPTGROUP:!0,OUTPUT:!0,PARAM:!0,PRE:!0,PROGRESS:!0,Q:!0,RP:!0,RT:!0,RUBY:!0,S:!0,SAMP:!0,SCRIPT:!0,SMALL:!0,SOURCE:!0,STRIKE:!0,STRONG:!0,STYLE:!0,SUB:!0,SUMMARY:!0,SUP:!0,TFOOT:!0,TIME:!0,TITLE:!0,TRACK:!0,TT:!0,U:!0,UL:!0,VAR:!0,VIDEO:!0,WBR:!0,OPTION:!0},MarvinPageExplorer.LINK_EXTRACT={EMBED:["SRC"],OBJECT:["CODEBASE","DATA"]},MarvinPageExplorer.LOGOUT_LINK_MATCH={attributes:["id","name","href","title","value"],matches:[/(sign|log)[\s-]?(out|off)/i]},MarvinPageExplorer.NOT_CLICKABLE_INPUTS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,file:!0,hidden:!0,month:!0,number:!0,password:!0,range:!0,reset:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},MarvinPageExplorer.EVENT_READY="ready",MarvinPageExplorer.EVENT_HASH_PART_DISCOVERED="HashPart",MarvinPageExplorer.MAXIMUM_PRESTART_STEPS=30,MarvinPageExplorer.prototype={addNewHref:function(e){this.testingPhase||"string"==typeof e&&(this.discoveredHrefs.hasOwnProperty(e)?this.discoveredHrefs[e]+=1:this.discoveredHrefs[e]=1)},addFindingsObject:function(e){this.additionalFindings.push(e)},addNewAlert:function(e,t){e in this.alertsFound||(this.alertsFound[e]=t)},addException:function(e,t){if("string"==typeof e)return void(this.errors.length<10&&this.errors.push(e));var i="";"message"in e&&(i+="Error: "+e.message+" "),"fileName"in e&&(i+="in file: "+e.fileName+" "),"lineNumber"in e&&(i+="at line: "+e.lineNumber+" "),t&&(i+="source: "+t+" "),""===i&&"toString"in e&&(i=e.toString()),""!==i&&this.errors.push(i)},looksLikeLogoutLink:function(e,t){var i,n,r=!1;if(""!=e){var a=e.toLowerCase();for(i=0,n=MarvinPageExplorer.LOGOUT_LINK_MATCH.attributes.length;n>i;i++)if(a==MarvinPageExplorer.LOGOUT_LINK_MATCH.attributes[i]){r=!0;break}}else r=!0;if(r){var o=MarvinPageExplorer.LOGOUT_LINK_MATCH.matches;for(i=0,n=o.length;n>i;i++)if(o[i].test(t))return!0}},excludedElement:function(e){this.isExternalLink(e)&&this.addNewHref(e.href);var t=e.tagName.toUpperCase();if("INPUT"===t&&"hidden"===e.type.toLowerCase())return!0;if(e.className&&"string"==typeof e.className&&-1!=e.className.indexOf("ui-dialog-titlebar-close"))return!0;if("A"===t&&"cancel"===e.innerText.toLowerCase())return!0;if(1==e.childNodes.length&&3==e.firstChild.nodeType&&this.looksLikeLogoutLink("",e.innerText))return!0;for(var i=0,n=e.attributes.length;n>i;i++){var r=e.attributes[i];if(this.looksLikeLogoutLink(r.name,r.value))return!0}return t in MarvinPageExplorer.EXCLUDED_TAGS},isExternalLink:function(e){return"A"===e.tagName.toUpperCase()&&"javascript:"!==e.protocol.toLowerCase()&&(location.origin!==e.origin||location.pathname!==e.pathname||location.search!==e.search)},extractLinksFrom:function(e){var t=e.tagName.toUpperCase();if(t in MarvinPageExplorer.LINK_EXTRACT)for(var i=0;i<MarvinPageExplorer.LINK_EXTRACT[t].length;i++)e.hasAttribute(MarvinPageExplorer.LINK_EXTRACT[t][i])&&this.addNewHref(e.getAttribute(MarvinPageExplorer.LINK_EXTRACT[t][i]));
},visitedSimilarElement:function(e){for(var t=new SparkMD5,i=e;i;){if(i.tagName&&t.append(i.tagName),i.name&&t.append(i.name),i.id&&t.append(i.id),i.className&&t.append(i.className),i.href&&t.append(i.href),e.attributes)for(var n=0;n<e.attributes.length;n++)0==e.attributes[n].name.indexOf("on")&&(t.append(e.attributes[n].name),t.append(e.attributes[n].value));i=i.parentElement}var r=e.getAttribute("onclick");r&&t.append(r),e.innerText&&t.append(e.innerText);var a=t.end(!0);return a in this.visitedElements?!0:(this.visitedElements[a]=!0,!1)},findNewTasks:function(e,t){if(e.nodeType&&3!=e.nodeType){window.$hook$.hookHTMLElement(e),window.$hook$.hookChildren(e);for(var i=e.querySelectorAll(t),n=[],r=[],a=0;a<i.length;a++)if(!i[a].hasBeenSeen&&(this.extractLinksFrom(i[a]),!this.excludedElement(i[a])&&!this.visitedSimilarElement(i[a])))if(this.executingTask&&this.tasks[this.currentTaskIndex].hasOwnProperty("addSubTaskForElement"))this.tasks[this.currentTaskIndex].addSubTaskForElement(i[a]);else{for(var o=!1,s=i[a];s;){if("FORM"==s.tagName){o=!0;break}s=s.parentElement}o?n.push(ElementExplorerFactory(i[a])):r.push(ElementExplorerFactory(i[a]))}this.tasks=this.tasks.concat(n),this.tasks=this.tasks.concat(r)}},addTimeoutTask:function(e,t){return this.executingTask&&this.tasks[this.currentTaskIndex]instanceof TimerTaskClass?void 0:(this.tasks.push(new TimerTaskClass(e,t)),this.tasks.length-1)},addListener:MarvinHooks.prototype.addListener,removeListener:MarvinHooks.prototype.removeListener,notifyListeners:MarvinHooks.prototype.notifyListeners,onXHRSend:function(){this.pendingRequests++},onXHRReady:function(){if(this.pendingRequests--,this.pendingRequests<=0&&this.waitingXHR){this.waitingXHR=!1;var e=this;window.$hook$.setTimeout(function(){e.next()},0)}},onElementAttributeSet:function(e,t){"href"===t.toLowerCase()&&this.isExternalLink(e)&&this.addNewHref(e.href)},onFormSubmitted:function(e){var t="";if("undefined"!=typeof marvinSessionObject&&(t=marvinSessionObject.getOuterHTMLForElement(e)),""!==t){var i=SparkMD5.hash(t,!0);i in this.discoveredForms||(this.discoveredForms[i]=t)}},onLocationSearch:function(e,t){this.testingPhase||""!=e&&this.validLocationSearch.test(e)&&(t?this.discoveredSearches[e]=t:"complete"===document.readyState&&-1==window.$hook$.indexOf(window.location.href,e)?this.notifyListeners(MarvinPageExplorer.EVENT_HASH_PART_DISCOVERED,e):this.discoveredSearches[e]=0)},start:function(){console.log("start");var e=!1,t=0;if("undefined"!=typeof marvinSessionObject&&(t=marvinSessionObject.pendingNetworkRequests),this.canStart?t>0?(this.prestartSteps++,e=!0):document.body||(this.prestartSteps++,e=!0):(this.prestartSteps++,this.canStart=!0,e=!0),e&&this.prestartSteps<MarvinPageExplorer.MAXIMUM_PRESTART_STEPS){var i=this;window.$hook$.setTimeout(function(){i.start()},250)}else document.body?(this.started=!0,e?console.log("starting anyway on "+window.location):console.log("starting on "+window.location),this.findNewTasks(window.document,MarvinPageExplorer.SELECTOR_QUERY),this.executingTask=!0,this.preNext()):(console.log("abandoning  "+window.location),this.ready())},abort:function(){console.log("aborting"),this.aborted=!0},pause:function(){console.log("pause"),this.paused=!0},resume:function(){this.paused&&(console.log("resume"),this.paused=!1)},preNext:function(){var e=this;return this.pendingRequests<=0?window.$hook$.setTimeout(function(){e.next()},0):this.waitingXHR=!0,!0},next:function(){if(this.aborted)return console.log("aborted"),this.tasksReady(),!1;var e=this;if(this.paused)return window.$hook$.setTimeout(function(){e.next()},1e3),!0;if(this.currentTaskIndex>=this.tasks.length)return this.tasksReady(),!1;var t=!1;try{t=this.tasks[this.currentTaskIndex].next()}catch(e){this.addException(e,"pageExplorer.js")}return!t&&(this.currentTaskIndex++,this.currentTaskIndex>=this.tasks.length)?(this.tasksReady(),!1):(window.$hook$.setTimeout(function(){e.preNext()},0),!0)},tasksReady:function(){var e=this;this.executingTask=!1,window.$hook$.setTimeout(function(){e.testingPhase=!0,e.notifyListeners(MarvinPageExplorer.EVENT_READY),e.currentTaskIndex>=e.tasks.length||e.aborted?e.ready():window.$hook$.setTimeout(function(){e.preNext()},0)},this.aborted?0:200)},ready:function(){console.log("ready");var e=[];for(var t in this.discoveredHrefs)this.discoveredHrefs.hasOwnProperty(t)&&e.push(t);var i=[];for(var n in this.discoveredForms)this.discoveredForms.hasOwnProperty(n)&&i.push(this.discoveredForms[n]);var r=[];for(var a in this.alertsFound)this.alertsFound.hasOwnProperty(a)&&r.push(this.alertsFound[a]);var o=[];for(var s in this.discoveredSearches)this.discoveredSearches.hasOwnProperty(s)&&o.push(s);for(var c=0;c<this.additionalFindings.length;c++)"links"in this.additionalFindings[c]&&(e=e.concat(this.additionalFindings[c].links)),"forms"in this.additionalFindings[c]&&(i=i.concat(this.additionalFindings[c].forms)),"alerts"in this.additionalFindings[c]&&(r=r.concat(this.additionalFindings[c].alerts)),"errors"in this.additionalFindings[c]&&(this.errors=this.errors.concat(this.additionalFindings[c].errors)),"searches"in this.additionalFindings[c]&&(o=o.concat(this.additionalFindings[c].searches));this.finalMessage={type:"explorer-ready",links:e,forms:i,alerts:r,errors:this.errors,searches:o},null==this.reportTo&&(this.finalMessage.cookie=document.cookie),this.sendFinalMessage()},sendFinalMessage:function(){null===this.reportTo?"undefined"!=typeof marvinSessionObject&&marvinSessionObject.sendData(this.finalMessage):this.reportTo.postMessage({msg:"ready",findings:this.finalMessage},"*")},documentChangedHandler:function(e){this.started?("SELECT"==e.tagName&&(e.$optionsMightBeChanged=!0),this.findNewTasks(e,MarvinPageExplorer.SELECTOR_QUERY)):this.canStart=!1},addingElement:function(){this.started||(this.canStart=!1)}},MarvinPageExplorer.prototype.start=function(){console.log("start "+window.location),this.executingTask=!0,this.preNext()},nullFunction=function(){},MarvinPageExplorer.prototype.findNewTasks=nullFunction,MarvinPageExplorer.prototype.onLocationSearch=nullFunction,MarvinPageExplorer.prototype.onFormSubmitted=nullFunction,SimpleDOMXSSClass.cases={fromLocation:{setupSource:function(){},checkSink:function(e,t,i){var n=SimpleDOMXSSClass.getStrData(t);if(""!==n){var r,a,o;e===SimpleDOMXSSClass.documentWriteSinkName?(o=MarvinPageExplorer.MatchXssWithSuffix(null,n,"locxss"))&&(r=cleanStackStrace(printStackTrace()),a="[i]Source: [/i][dark]window.location[/dark][break][i]Location: [/i][dark]"+window.location.href+"[/dark][break][i]Execution Sink: [/i][dark]document.write[/dark][break][i]HTML code written: [/i][pre]"+n.substring(o.index-512,o.index+512)+" ...[/pre]\n[i]Stack Trace: [/i][break]"+r,window.$uie$.addNewAlert(SparkMD5.hash(a),{template:"DOM_XSS.xml",details:a})):e===SimpleDOMXSSClass.setHTMLSinkName?(o=MarvinPageExplorer.MatchXssWithSuffix(i,n,"locxss"))&&(r=cleanStackStrace(printStackTrace()),a="[i]Source: [/i][dark]window.location[/dark][break][i]Location: [/i][dark]"+window.location.href+"[/dark][break][i]Execution Sink: [/i][dark]set HTML code[/dark][break][i]HTML code set: [/i][pre]"+n.substring(o.index-512,o.index+512)+" ...[/pre]\n[i]Stack Trace: [/i][break]"+r,window.$uie$.addNewAlert(SparkMD5.hash(a),{template:"DOM_XSS.xml",details:a})):e===SimpleDOMXSSClass.evalSinkName?(o=MarvinPageExplorer.MatchXssWithSuffix(null,n,"locxss"))&&(r=cleanStackStrace(printStackTrace()),a="[i]Source: [/i][dark]window.location[/dark][break][i]Location: [/i][dark]"+window.location.href+"[/dark][break][i]Execution Sink: [/i][dark]evaluate code[/dark][break][i]Code evaluated: [/i][pre]"+n.substring(o.index-512,o.index+512)+" ...[/pre]\n[i]Stack Trace: [/i][break]"+r,window.$uie$.addNewAlert(SparkMD5.hash(a),{template:"DOM_XSS.xml",details:a})):e===SimpleDOMXSSClass.windowOpenSinkName&&(o=MarvinPageExplorer.MatchXssWithSuffix(null,n.trim(),"locxss"))&&0==o.index&&(r=cleanStackStrace(printStackTrace()),a="[i]Source: [/i][dark]window.location[/dark][break][i]Location: [/i][dark]"+window.location.href+"[/dark][break][i]Execution Sink: [/i][dark]window.open[/dark][break][i]URL: [/i][pre]"+n.substring(0,1204)+" ...[/pre]\n[i]Stack Trace: [/i][break]"+r,window.$uie$.addNewAlert(SparkMD5.hash(a),{template:"DOM_XSS.xml",details:a}))}}}},window.$hook$=new MarvinHooks,window.$uie$=new MarvinPageExplorer,window.$sdx$=new SimpleDOMXSSClass(!0);
